# åˆ—è¡¨æ¨å¯¼ã€å‡½æ•°ä½œä¸ºå¯¹è±¡ã€æµ‹è¯•ã€è°ƒè¯•

###  åˆ—è¡¨æ¨å¯¼å¼

#### åŸºæœ¬ç»“æ„

```python
new_list = [expression for item in iterable if condition]
```

- **expression**ï¼šå¯¹æ¯ä¸ªé¡¹æ‰§è¡Œçš„æ“ä½œã€‚
- **item**ï¼šè¡¨ç¤ºå½“å‰è¿­ä»£å…ƒç´ çš„å˜é‡ã€‚
- **iterable**ï¼šè¦è¿­ä»£çš„é›†åˆï¼ˆä¾‹å¦‚ï¼Œåˆ—è¡¨ã€èŒƒå›´ï¼‰ã€‚
- **condition**ï¼šä¸€ä¸ªå¯é€‰çš„è¿‡æ»¤å™¨ï¼Œç”¨äºç¡®å®šæ˜¯å¦åº”ç”¨è¡¨è¾¾å¼ã€‚

##### åˆ—è¡¨æ¨å¯¼å¼ç¤ºä¾‹

```python
def square_elements(L):
    Lnew = []  # åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºåˆ—è¡¨
    for e in L:  # éå† L ä¸­çš„æ¯ä¸ªå…ƒç´ 
        Lnew.append(e**2)  # å°† e çš„å¹³æ–¹æ·»åŠ åˆ° Lnew
    return Lnew  # è¿”å›æ–°åˆ—è¡¨
```

è¿™å¯ä»¥ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼ç®€åŒ–ä¸ºï¼š

```python
Lnew = [e**2 for e in L]  # åˆ›å»ºä¸€ä¸ªåŒ…å« L ä¸­å…ƒç´ å¹³æ–¹çš„æ–°åˆ—è¡¨
```

ä½ è¿˜å¯ä»¥æ·»åŠ æ¡ä»¶æ¥è¿‡æ»¤å“ªäº›å…ƒç´ åŒ…å«åœ¨æ–°åˆ—è¡¨ä¸­ã€‚ä¾‹å¦‚ï¼Œä»…åŒ…å«å¶æ•°çš„å¹³æ–¹ï¼š

```python
Lnew = [e**2 for e in L if e % 2 == 0]  # ä»…å¹³æ–¹å¶æ•°å…ƒç´ 
```

| **ç¤ºä¾‹**                                                  | **æè¿°**                                    |
| --------------------------------------------------------- | ------------------------------------------- |
| `squares = [e**2 for e in range(6)]`                      | åˆ›å»ºä¸€ä¸ªä» 0 åˆ° 5 çš„å¹³æ–¹åˆ—è¡¨ã€‚              |
| `even_squares = [e**2 for e in range(8) if e % 2 == 0]`   | å¹³æ–¹ 0 åˆ° 7 çš„å¶æ•°ï¼Œç»“æœä¸º [0, 4, 16, 36]ã€‚ |
| `pair_list = [[e, e**2] for e in range(4) if e % 2 == 1]` | åˆ›å»ºä¸€ä¸ªåŒ…å«å¥‡æ•°åŠå…¶å¹³æ–¹çš„åˆ—è¡¨ã€‚            |

### å‡½æ•°é»˜è®¤å‚æ•°

#### é—®é¢˜èƒŒæ™¯

ä»¥äºŒåˆ†æ³•æ±‚å¹³æ–¹æ ¹å‡½æ•°ä¸ºä¾‹ï¼š

```python
def bisection_root_new(x, epsilon):
    num_guesses = 0
    low = 0
    high = x
    guess = (high + low)/2.0
    while abs(guess**2 - x) >= epsilon:
        if guess**2 < x: 
            low = guess
        else: 
            high = guess
        guess = (high + low)/2.0
        num_guesses += 1
    print('num_guesses =', num_guesses)
    return guess

# print(bisection_root_new(123, 0.1))
# print(bisection_root_new(123, 0.00001))


### æ”¹è¿›çš„äºŒåˆ†å¹³æ–¹æ ¹ä½œä¸ºå‡½æ•°
# å°† x å’Œ Îµ ä½œä¸ºé»˜è®¤å‚æ•°
def bisection_root_new(x, epsilon=0.01):
    num_guesses = 0
    low = 0
    high = x
    guess = (high + low)/2.0
    while abs(guess**2 - x) >= epsilon:
        if guess**2 < x: 
            low = guess
        else: 
            high = guess
        guess = (high + low)/2.0
        num_guesses += 1
    print('num_guesses =', num_guesses)
    return guess

# print(bisection_root_new(123))
# print(bisection_root_new(123, 0.5))
# print(bisection_root_new(123, epsilon=0.00001))
# print(bisection_root_new(epsilon=0.001, x=123)) 
```

#### å‡½æ•°çš„é»˜è®¤å‚æ•°ä¸å…³é”®å­—å‚æ•°

##### é»˜è®¤å‚æ•°çš„å®šä¹‰ä¸ä½¿ç”¨

> é»˜è®¤å‚æ•°ï¼ˆä¹Ÿç§°ä¸ºå…³é”®å­—å‚æ•°ï¼‰å…è®¸å‡½æ•°åœ¨æœªæ¥æ”¶ç‰¹å®šå‚æ•°å€¼æ—¶ä½¿ç”¨é¢„è®¾çš„é»˜è®¤å€¼

**å®šä¹‰é»˜è®¤å‚æ•°çš„è§„åˆ™**ï¼š

- é»˜è®¤å‚æ•°å¿…é¡»ä½äºå‚æ•°åˆ—è¡¨çš„æœ«å°¾
- åœ¨å‡½æ•°å®šä¹‰æ—¶é€šè¿‡`å‚æ•°å=é»˜è®¤å€¼`çš„å½¢å¼è®¾ç½®

ç¤ºä¾‹ï¼š

```python
def bisection_root(x, epsilon=0.01):   
```

#### å‡½æ•°è°ƒç”¨çš„å¤šç§æ–¹å¼

| è°ƒç”¨æ–¹å¼             | ç¤ºä¾‹                                 | è¯´æ˜                  |
| -------------------- | ------------------------------------ | --------------------- |
| ä»…ä¼ å…¥å¿…éœ€å‚æ•°       | `bisection_root(123)`                | ä½¿ç”¨é»˜è®¤epsilonå€¼0.01 |
| æŒ‰é¡ºåºä¼ å…¥æ‰€æœ‰å‚æ•°   | `bisection_root(123, 0.5)`           | è¦†ç›–é»˜è®¤epsilonå€¼     |
| ä½¿ç”¨å‚æ•°åä¼ å…¥       | `bisection_root(x=123, epsilon=0.1)` | æ˜¾å¼æŒ‡å®šå‚æ•°åç§°      |
| ä½¿ç”¨å‚æ•°åä¸”é¡ºåºä»»æ„ | `bisection_root(epsilon=0.1, x=123)` | é€šè¿‡åç§°åŒ¹é…å‚æ•°      |

**é”™è¯¯ç¤ºä¾‹**ï¼š

- âŒ é»˜è®¤å‚æ•°åœ¨éé»˜è®¤å‚æ•°ä¹‹å‰ï¼š`bisection_root(epsilon=0.1, 123)`
- âš ï¸ å‚æ•°é¡ºåºæ··æ·†ï¼š`bisection_root(0.001, 123)` ï¼ˆä¼šå¯¼è‡´å‚æ•°å€¼é”™è¯¯åŒ¹é…ï¼‰

### å‡½æ•°ä½œä¸ºå¯¹è±¡

#### å‡½æ•°åˆ«å

> åœ¨Pythonä¸­ï¼Œå‡½æ•°æ˜¯å¯¹è±¡ï¼Œå¯ä»¥åƒå…¶ä»–å¯¹è±¡ä¸€æ ·è¢«å¼•ç”¨å’Œä¼ é€’

```python
def is_even(n):    # å‡½æ•°å®ç°...     
my_func = is_even  # åˆ›å»ºå‡½æ•°åˆ«å
```

- `is_even`å’Œ`my_func`æŒ‡å‘ç›¸åŒçš„å‡½æ•°å¯¹è±¡
- è°ƒç”¨æ•ˆæœç›¸åŒï¼š`is_even(4)` ç­‰ä»·äº `my_func(4)`

### å‡½æ•°è¿”å›å‡½æ•°

#### å‡½æ•°åµŒå¥—å®šä¹‰çš„åŸºæœ¬æ¦‚å¿µ

> å‡½æ•°å¯ä»¥åœ¨å…¶å†…éƒ¨å®šä¹‰å¦ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å°†è¯¥å‡½æ•°ä½œä¸ºè¿”å›å€¼è¿”å›ç»™è°ƒç”¨è€…

**ä¸»è¦ç‰¹ç‚¹**ï¼š

- å†…éƒ¨å®šä¹‰çš„å‡½æ•°åªåœ¨å®šä¹‰å®ƒçš„å‡½æ•°ä½œç”¨åŸŸå†…å¯è§
- é€šè¿‡è¿”å›å†…éƒ¨å‡½æ•°ï¼Œå¯ä»¥è®©å¤–éƒ¨ä½œç”¨åŸŸè®¿é—®åˆ°è¿™ä¸ªå‡½æ•°
- è¿”å›çš„æ˜¯å‡½æ•°å¯¹è±¡ï¼Œè€Œä¸æ˜¯å‡½æ•°è°ƒç”¨çš„ç»“æœ

#### å‡½æ•°é“¾å¼è°ƒç”¨ç¤ºä¾‹

```python
def make_prod(a):    
    def g(b):        
        return a * b    
    return g 
val = make_prod(2)(3)  # ç»“æœä¸º6
```

**æ‰§è¡Œè¿‡ç¨‹åˆ†æ**ï¼š

1. `make_prod(2)`æ‰§è¡Œæ—¶ï¼š
   - åˆ›å»º`make_prod`çš„å±€éƒ¨ä½œç”¨åŸŸ
   - å‚æ•°`a`ç»‘å®šå€¼`2`
   - å®šä¹‰å†…éƒ¨å‡½æ•°`g`
   - è¿”å›å‡½æ•°`g`çš„å¼•ç”¨
2. `(3)`æ‰§è¡Œæ—¶ï¼š
   - è°ƒç”¨è¿”å›çš„å‡½æ•°`g`
   - å‚æ•°`b`ç»‘å®šå€¼`3`
   - `g`å‡½æ•°ä½“è®¿é—®å¤–å±‚ä½œç”¨åŸŸçš„`a`å€¼ï¼ˆ2ï¼‰
   - è®¡ç®—`2 * 3`å¹¶è¿”å›`6`

###### 1. `return g` ï¼ˆå¤–å±‚å‡½æ•° `make_prod`ï¼‰

```python
def make_prod(a):
    def g(b):
        return a * b
    return g
```

- è¿™æ˜¯ `make_prod` å‡½æ•°çš„è¿”å›è¯­å¥ã€‚å®ƒè¿”å›çš„æ˜¯å†…éƒ¨å®šä¹‰çš„å‡½æ•° `g`ï¼Œè€Œä¸æ˜¯æ‰§è¡Œ `g`ã€‚
- `make_prod(a)` çš„ä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•° `g`ï¼Œè¿™ä¸ª `g` å‡½æ•°æ˜¯é—­åŒ…ï¼ˆclosureï¼‰ï¼Œå®ƒä¼šè®°ä½å¤–éƒ¨ä½œç”¨åŸŸä¸­ `a` çš„å€¼ã€‚
- è¿™ä¸ªè¿”å›å€¼ï¼ˆå³å‡½æ•° `g`ï¼‰åŒ…å«äº† `a`ï¼Œä½† `a` æœ¬èº«åœ¨ `make_prod` æ‰§è¡Œå®Œåå·²ç»â€œæ¶ˆå¤±â€äº†ã€‚å› æ­¤ï¼Œ`g` èƒ½å¤Ÿåœ¨åç»­è°ƒç”¨æ—¶ä½¿ç”¨ `a` çš„å€¼ã€‚

###### 2. `return a * b` ï¼ˆå†…å±‚å‡½æ•° `g`ï¼‰

```python
def g(b):
    return a * b
```

- è¿™æ˜¯å†…å±‚å‡½æ•° `g` ä¸­çš„ `return`ï¼Œå®ƒè¿”å›çš„æ˜¯ `a * b` çš„è®¡ç®—ç»“æœã€‚
- `g` æ˜¯ä¸€ä¸ªç®€å•çš„ä¹˜æ³•å‡½æ•°ï¼Œå®ƒç”¨ `a`ï¼ˆæ¥è‡ªå¤–å±‚å‡½æ•° `make_prod`ï¼‰å’Œ `b`ï¼ˆä½œä¸ºå‚æ•°ä¼ å…¥ï¼‰è¿›è¡Œç›¸ä¹˜ï¼Œè¿”å›ç»“æœã€‚
- åœ¨æ‰§è¡Œ `g(b)` æ—¶ï¼Œ`a` çš„å€¼æ˜¯ `make_prod(a)` è¢«è°ƒç”¨æ—¶ä¼ å…¥çš„å‚æ•°ã€‚

### æ˜¾å¼ä¸­é—´æ­¥éª¤æ–¹å¼

```python
def make_prod(a):
    def g(b):
        return a * b    
    return g 
doubler = make_prod(2)  # ä¿å­˜è¿”å›çš„å‡½æ•° 
val = doubler(3)        # è°ƒç”¨ä¿å­˜çš„å‡½æ•°
```

| æ–¹å¼         | ç‰¹ç‚¹                 |
| ------------ | -------------------- |
| é“¾å¼è°ƒç”¨     | ä»£ç æ›´ç®€æ´ï¼Œç›´è§‚     |
| æ˜¾å¼ä¸­é—´æ­¥éª¤ | è¿‡ç¨‹æ›´æ¸…æ™°ï¼Œä¾¿äºç†è§£ |

## ğŸ“‹ æµ‹è¯•ä¸éªŒè¯

### æµ‹è¯•ç±»å‹

| æµ‹è¯•ç±»å‹ | ä¸»è¦å†…å®¹                        | ç‰¹ç‚¹                   |
| -------- | ------------------------------- | ---------------------- |
| å•å…ƒæµ‹è¯• | é’ˆå¯¹å•ä¸ªå‡½æ•°è¿›è¡Œä¸åŒè¾“å…¥æµ‹è¯•    | æœ€åŸºç¡€çš„æµ‹è¯•ç±»å‹       |
| å›å½’æµ‹è¯• | ä¿®å¤bugåé‡æ–°è¿è¡Œä¹‹å‰çš„æµ‹è¯•ç”¨ä¾‹ | ç¡®ä¿æ–°ä¿®å¤ä¸å¼•å…¥æ–°é—®é¢˜ |
| é›†æˆæµ‹è¯• | æµ‹è¯•å¤šä¸ªæ¨¡å—ç»„åˆåçš„åŠŸèƒ½        | éªŒè¯æ¨¡å—é—´äº¤äº’         |

### æµ‹è¯•æ–¹æ³•

#### é»‘ç›’æµ‹è¯•

> ä»…åŸºäºå‡½æ•°è§„èŒƒï¼ˆæ–‡æ¡£å­—ç¬¦ä¸²ï¼‰è®¾è®¡æµ‹è¯•ç”¨ä¾‹ï¼Œä¸å…³æ³¨å…·ä½“å®ç°

**ä¼˜åŠ¿**ï¼š

- æµ‹è¯•ç”¨ä¾‹ç‹¬ç«‹äºå…·ä½“å®ç°
- å³ä½¿å®ç°æ–¹å¼æ”¹å˜ï¼Œæµ‹è¯•ç”¨ä¾‹ä»ç„¶æœ‰æ•ˆ

**ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹**ï¼ˆé’ˆå¯¹å¹³æ–¹æ ¹å‡½æ•°ï¼‰ï¼š

- è¾“å…¥å€¼(*x*)æµ‹è¯•ï¼š
  - *x*=0
  - å°äº1çš„å®Œå…¨å¹³æ–¹æ•°
  - æ— ç†æ•°å€¼
  - è¾¹ç•Œå€¼
- ç²¾åº¦å€¼(*e**p**s**i**l**o**n*)æµ‹è¯•ï¼š
  - åˆç†èŒƒå›´å†…çš„å€¼
  - æé™æƒ…å†µ

#### ç»ç’ƒç›’æµ‹è¯•

> åŸºäºä»£ç å®ç°è®¾è®¡æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿è¦†ç›–æ‰€æœ‰ä»£ç è·¯å¾„

**ç‰¹ç‚¹**ï¼š

- éœ€è¦æŸ¥çœ‹å…·ä½“ä»£ç å®ç°
- ç›®æ ‡æ˜¯å®ç°è·¯å¾„å®Œæ•´æ€§

### æµ‹è¯•ç”¨ä¾‹è®¾è®¡æ–¹æ³•

1. **åŸºäºç›´è§‰**ï¼šæ ¹æ®é—®é¢˜è‡ªç„¶è¾¹ç•Œè®¾è®¡
2. **éšæœºæµ‹è¯•**ï¼šå¢åŠ æµ‹è¯•ç”¨ä¾‹æ•°é‡æé«˜å‘ç°bugæ¦‚ç‡
3. **è¾¹ç•Œæµ‹è¯•**ï¼šå…³æ³¨æé™æƒ…å†µå’Œç‰¹æ®Šå€¼

## ğŸ§ª è½¯ä»¶æµ‹è¯•ç­–ç•¥

### ç™½ç›’æµ‹è¯•è¦ç‚¹

- **åˆ†æ”¯è¦†ç›–**

  - æ¯ä¸ª if åˆ†æ”¯éƒ½éœ€è¦æµ‹è¯•
  - æ¯ä¸ª else/elif åˆ†æ”¯éƒ½éœ€è¦æµ‹è¯•

- **å¾ªç¯æµ‹è¯•**

  > å¯¹äºå¾ªç¯ç»“æ„éœ€è¦æµ‹è¯•ä»¥ä¸‹åœºæ™¯:

  - å®Œå…¨ä¸æ‰§è¡Œå¾ªç¯
  - æ‰§è¡Œä¸€æ¬¡å¾ªç¯
  - æ‰§è¡Œå¤šæ¬¡å¾ªç¯

### ç™½ç›’æµ‹è¯•çš„å±€é™æ€§

- **è·¯å¾„å®Œå¤‡æ€§ä¸ç­‰äºæ­£ç¡®æ€§**

  ```python
  def abs(x):    
      if x < -1:        
          return -x    
      else:        
          return x
  ```

  ä¸Šè¿°ä»£ç çš„æµ‹è¯•ç”¨ä¾‹:

  | è¾“å…¥ | é¢„æœŸè¾“å‡º | å®é™…è¾“å‡º | é—®é¢˜           |
  | ---- | -------- | -------- | -------------- |
  | 2    | 2        | 2        | é€šè¿‡           |
  | -2   | 2        | 2        | é€šè¿‡           |
  | -1   | 1        | -1       | æœªæµ‹å‡ºè¾¹ç•Œé”™è¯¯ |

- **éœ€è¦å…³æ³¨è¾¹ç•Œæ¡ä»¶**

  - ç‰¹åˆ«æ˜¯åœ¨æ¡ä»¶åˆ¤æ–­è¯­å¥ä¸­çš„è¾¹ç•Œå€¼
  - ä¸èƒ½ä»…ä¾èµ–è·¯å¾„è¦†ç›–

## ğŸ” è°ƒè¯•æŠ€å·§

### å¸¸è§é”™è¯¯ç±»å‹

| é”™è¯¯ç±»å‹    | ç‰¹å¾             | å¤„ç†æ–¹æ³•                 |
| ----------- | ---------------- | ------------------------ |
| IndexError  | ç´¢å¼•è¶Šç•Œ         | æ£€æŸ¥ç´¢å¼•å˜é‡å’Œè¢«ç´¢å¼•å¯¹è±¡ |
| TypeError   | ç±»å‹ä¸åŒ¹é…       | æ£€æŸ¥æ•°æ®ç±»å‹è½¬æ¢         |
| NameError   | å˜é‡æœªå®šä¹‰       | æ£€æŸ¥å˜é‡åˆå§‹åŒ–           |
| SyntaxError | è¯­æ³•é”™è¯¯         | æ£€æŸ¥ç¼©è¿›ã€æ‹¬å·ç­‰         |
| é€»è¾‘é”™è¯¯    | è¾“å‡ºç»“æœä¸ç¬¦é¢„æœŸ | éœ€è¦æ·±å…¥åˆ†æ             |

### è°ƒè¯•æ–¹æ³•

1. **ç³»ç»ŸåŒ–è°ƒè¯•**

   - ä¸è¦éšæœºä¿®æ”¹ä»£ç 
   - åˆ†æå¤±è´¥æµ‹è¯•ç”¨ä¾‹çš„å…±åŒç‚¹
   - å®šä½å¯èƒ½å‡ºé—®é¢˜çš„ä»£ç æ®µ

2. **ç§‘å­¦æ–¹æ³•**

   - è§‚å¯Ÿæ•°æ®
   - å½¢æˆå‡è®¾
   - éªŒè¯å‡è®¾

3. **äºŒåˆ†æ³•è°ƒè¯•**

   > åœ¨ä»£ç ä¸­é—´ä½ç½®æ·»åŠ æ‰“å°è¯­å¥ï¼Œé€æ­¥ç¼©å°é—®é¢˜èŒƒå›´

   - å¦‚æœä¸­ç‚¹å¤„æ•°æ®æ­£ç¡®ï¼Œé—®é¢˜åœ¨ååŠéƒ¨åˆ†
   - å¦‚æœä¸­ç‚¹å¤„æ•°æ®é”™è¯¯ï¼Œé—®é¢˜åœ¨å‰åŠéƒ¨åˆ†
   - ç»§ç»­å¯¹é—®é¢˜åŒºåŸŸè¿›è¡ŒäºŒåˆ†

4. **è¾…åŠ©è°ƒè¯•æ‰‹æ®µ**

   - ä½¿ç”¨æ‰“å°è¯­å¥
   - ä½¿ç”¨Python Tutorç­‰å¯è§†åŒ–å·¥å…·

```python
## STEP 1: run it with test cases
def is_pal(x):
    """ Returns True is list x is a palindrome and False otherwise """
    temp = x
    temp.reverse
    if temp == x:
        return True
    else:
        return False

print(is_pal(list('abcba')))  # input is ['a','b','c','b','a']
print(is_pal(list('ab')))     # input is ['a','b']

## STEP 2: add print statements about halfway through       
def is_pal(x):
    """ Returns True is list x is a palindrome and False otherwise """
    temp = x
    temp.reverse
    print(temp, x)  # add this
    if temp == x:
        return True
    else:
        return False

print(is_pal(list('abcba')))  # input is ['a','b','c','b','a']
print(is_pal(list('ab')))     # input is ['a','b']
 
## STEP 3: Add more print statements before and after critical points
def is_pal(x):
    """ Returns True is list x is a palindrome and False otherwise """
    temp = x
    print('before reverse', temp, x)  # add this
    temp.reverse
    print('after reverse', temp, x)  # add this
    if temp == x:
        return True
    else:
        return False
 
print(is_pal(list('abcba')))  # input is ['a','b','c','b','a']
print(is_pal(list('ab')))     # input is ['a','b']

## STEP 4: Fix one issue, notice something is still wrong
def is_pal(x):
    """ Returns True is list x is a palindrome and False otherwise """
    temp = x
    print('before reverse', temp, x)
    temp.reverse()                      # fix this
    print('after reverse', temp, x)
    if temp == x:
        return True
    else:
        return False

print(is_pal(list('abcba')))  # input is ['a','b','c','b','a']
print(is_pal(list('ab')))     # input is ['a','b']

## STEP 5: Recall with lists, aliasing/mutability is an issue
def is_pal(x):
    """ Returns True is list x is a palindrome and False otherwise """
    temp = x[:]     # fix this
    print('before reverse', temp, x)
    temp.reverse()
    print('after reverse', temp, x)
    if temp == x:
        return True
    else:
        return False

print(is_pal(list('abcba')))  # input is ['a','b','c','b','a']
print(is_pal(list('ab')))     # input is ['a','b']
```

